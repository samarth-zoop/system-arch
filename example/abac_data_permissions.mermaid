graph TB
    subgraph ResourceData["ğŸ“Š Resource: Project 'Q4 Campaign'"]
        Project[Project ID: proj-123<br/>Name: Q4 Sales Campaign<br/>Budget: $50,000<br/>Team: 5 members<br/>Status: Active]
    end

    subgraph ResourcePermissions["ğŸ” Resource Permissions Table"]
        RP1[User: Alice<br/>Level: OWNER<br/>Granted by: Alice]
        RP2[User: Bob<br/>Level: EDITOR<br/>Granted by: Alice]
        RP3[User: Charlie<br/>Level: VIEWER<br/>Granted by: Alice]
        RP4[User: Diana<br/>Level: VIEWER<br/>Granted by: Bob<br/>Expires: 30 days]
    end

    Project --> RP1 & RP2 & RP3 & RP4

    subgraph AliceAccess["ğŸ‘¤ Alice's Access (OWNER)"]
        Alice[Alice requests:<br/>GET /projects/123]
        AlicePerms[Check: Alice = OWNER<br/>âœ… Full Access]
        AliceData[Returns ALL fields:<br/>âœ… project_id: 123<br/>âœ… name: Q4 Campaign<br/>âœ… budget: $50,000<br/>âœ… spent: $32,000<br/>âœ… profit_margin: 35%<br/>âœ… internal_notes<br/>âœ… team_members<br/>âœ… Can DELETE<br/>âœ… Can SHARE<br/>âœ… Can EDIT]
    end

    subgraph BobAccess["ğŸ‘¤ Bob's Access (EDITOR)"]
        Bob[Bob requests:<br/>GET /projects/123]
        BobPerms[Check: Bob = EDITOR<br/>âš ï¸ Limited Access]
        BobData[Returns filtered fields:<br/>âœ… project_id: 123<br/>âœ… name: Q4 Campaign<br/>âœ… description<br/>âœ… team_members<br/>âœ… status<br/>âŒ budget HIDDEN<br/>âŒ profit_margin HIDDEN<br/>âŒ internal_notes HIDDEN<br/>âœ… Can EDIT most fields<br/>âŒ Cannot DELETE<br/>âŒ Cannot SHARE]
    end

    subgraph CharlieAccess["ğŸ‘¤ Charlie's Access (VIEWER)"]
        Charlie[Charlie requests:<br/>GET /projects/123]
        CharliePerms[Check: Charlie = VIEWER<br/>ğŸ”’ Read-Only]
        CharlieData[Returns basic fields:<br/>âœ… project_id: 123<br/>âœ… name: Q4 Campaign<br/>âœ… description<br/>âœ… status<br/>âŒ budget HIDDEN<br/>âŒ team_members HIDDEN<br/>âŒ internal_notes HIDDEN<br/>âŒ profit_margin HIDDEN<br/>âŒ Cannot EDIT<br/>âŒ Cannot DELETE<br/>âŒ Cannot SHARE]
    end

    subgraph DianaAccess["ğŸ‘¤ Diana's Access (VIEWER + Temporary)"]
        Diana[Diana requests:<br/>GET /projects/123]
        DianaCheck{Check<br/>expiration}
        DianaPerms[Check: Diana = VIEWER<br/>Expires in 25 days<br/>ğŸ”’ Read-Only]
        DianaExpired[âŒ Access Expired<br/>403 Forbidden]
        DianaData[Returns basic fields:<br/>(Same as Charlie)<br/>âœ… project_id: 123<br/>âœ… name: Q4 Campaign<br/>âœ… description<br/>âœ… status<br/>âŒ Sensitive fields HIDDEN<br/>â° Access until: Nov 30]
    end

    subgraph NoAccess["ğŸš« User Without Access"]
        Eve[Eve requests:<br/>GET /projects/123]
        EveCheck[Check resource_permissions:<br/>No record found]
        EveError[âŒ 403 Access Denied<br/>You do not have permission<br/>to view this project]
    end

    RP1 --> AlicePerms
    Alice --> AlicePerms
    AlicePerms --> AliceData

    RP2 --> BobPerms
    Bob --> BobPerms
    BobPerms --> BobData

    RP3 --> CharliePerms
    Charlie --> CharliePerms
    CharliePerms --> CharlieData

    RP4 --> DianaCheck
    Diana --> DianaCheck
    DianaCheck -->|Not Expired| DianaPerms
    DianaCheck -->|After 30 days| DianaExpired
    DianaPerms --> DianaData

    Eve --> EveCheck
    EveCheck --> EveError

    subgraph PermissionHierarchy["ğŸ“Š Permission Level Hierarchy"]
        Owner[OWNER<br/>Level 3<br/>â”â”â”â”â”â”â”â”<br/>Can:<br/>â€¢ View all fields<br/>â€¢ Edit all fields<br/>â€¢ Delete resource<br/>â€¢ Share with others<br/>â€¢ Change permissions<br/>â€¢ Full control]
        Editor[EDITOR<br/>Level 2<br/>â”â”â”â”â”â”â”â”<br/>Can:<br/>â€¢ View most fields<br/>â€¢ Edit most fields<br/>â€¢ Limited access<br/><br/>Cannot:<br/>â€¢ View financials<br/>â€¢ Delete resource<br/>â€¢ Share with others]
        Viewer[VIEWER<br/>Level 1<br/>â”â”â”â”â”â”â”â”<br/>Can:<br/>â€¢ View basic fields<br/>â€¢ Read-only access<br/><br/>Cannot:<br/>â€¢ Edit anything<br/>â€¢ View sensitive data<br/>â€¢ Delete resource<br/>â€¢ Share with others]
        
        Owner -->|higher than| Editor
        Editor -->|higher than| Viewer
    end

    subgraph Actions["ğŸ¬ Common Actions & Required Levels"]
        A1[View Project<br/>Required: VIEWER+]
        A2[Edit Description<br/>Required: EDITOR+]
        A3[Edit Budget<br/>Required: OWNER]
        A4[Delete Project<br/>Required: OWNER]
        A5[Share Project<br/>Required: OWNER]
        A6[View Team Members<br/>Required: EDITOR+]
        A7[Assign Tasks<br/>Required: EDITOR+]
    end

    Viewer -.->|can do| A1
    Editor -.->|can do| A1 & A2 & A6 & A7
    Owner -.->|can do| A1 & A2 & A3 & A4 & A5 & A6 & A7

    subgraph Example["ğŸ’¡ Real-World Example"]
        Scenario[Scenario: Bob tries to delete project]
        Check1[Check: Does Bob have 'delete_projects' API permission?<br/>Result: YES âœ“ Bob's role has this]
        Check2[Check: Does Bob have OWNER level on proj-123?<br/>Result: NO âœ— Bob is only EDITOR]
        Result[âŒ 403 Forbidden<br/>You need OWNER permission to delete this project]
        
        Scenario --> Check1
        Check1 --> Check2
        Check2 --> Result
    end

    %% Styling
    classDef ownerStyle fill:#c8e6c9,stroke:#388e3c,stroke-width:3px
    classDef editorStyle fill:#fff9c4,stroke:#f9a825,stroke-width:2px
    classDef viewerStyle fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    classDef errorStyle fill:#ffebee,stroke:#c62828,stroke-width:2px
    classDef resourceStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px

    class AlicePerms,AliceData,Owner ownerStyle
    class BobPerms,BobData,Editor editorStyle
    class CharliePerms,CharlieData,DianaPerms,DianaData,Viewer viewerStyle
    class EveError,DianaExpired,Result errorStyle
    class Project,RP1,RP2,RP3,RP4 resourceStyle
